import CodeBlock from "../../CodeBlock.astro"
import MPADemo from "../../MPADemo.astro"

export const filenames = {
  one: "index.html",
  two: "step-2.html",
  three: "step-3.html",
  four: "step-4.html",
  five: "step-5.html",
  six: "step-6.html",
  seven: "step-7.html",
  eight: "base-styles.css",
  nine: "styles.css",
  ten: "script.js",
}

<MPADemo title="Jake Archibald's Survey Demo as an MPA" filenames={filenames}>
<CodeBlock slot="one" id="one">
index.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 1">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />
    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 1</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock>
<CodeBlock slot="two" id="two">
step-2.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 2">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />

    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 2</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock>
<CodeBlock slot="three" id="three">
step-3.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 3">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />

    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 3</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock>
<CodeBlock slot="four" id="four">
step-4.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 4">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />

    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 4</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock> 
<CodeBlock slot="five" id="five">
step-5.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 5">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />

    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 5</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock>
<CodeBlock slot="six" id="six">
step-6.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 6">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />

    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 6</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock>
<CodeBlock slot="seven" id="seven">
step-7.html
```html
<!DOCTYPE html>
<html lang="en" style="--step: 7">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="view-transition" content="same-origin" />

    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <title>Demo</title>
    <link rel="stylesheet" href="/survey/base-styles.css" />
    <link rel="stylesheet" href="/survey/styles.css" />
    <script type="module" src="/survey/script.js"></script>
  </head>
  <body>
    <header class="main-header">
      <span class="main-header-text">Jake Archibald's Survey Demo</span>
    </header>
    <main class="content">
      <h1 class="content-title">Step 7</h1>
      <ol>
        <li><a href="./">Step 1</a></li>
        <li><a href="./step-2.html">Step 2</a></li>
        <li><a href="./step-3.html">Step 3</a></li>
        <li><a href="./step-4.html">Step 4</a></li>
        <li><a href="./step-5.html">Step 5</a></li>
        <li><a href="./step-6.html">Step 6</a></li>
        <li><a href="./step-7.html">Step 7</a></li>
      </ol>
    </main>
    <div class="survey-progress">
      <div class="survey-ticks">
        <div style="--tick-pos: 0"></div>
        <div style="--tick-pos: 1"></div>
        <div style="--tick-pos: 2"></div>
        <div style="--tick-pos: 3"></div>
        <div style="--tick-pos: 4"></div>
        <div style="--tick-pos: 5"></div>
        <div style="--tick-pos: 6"></div>
        <div class="survey-current" style="--tick-pos: calc(var(--step) - 1)">
          <div class="survey-current-nums"></div>
        </div>
      </div>
    </div>
  </body>
</html>
```
</CodeBlock>
<CodeBlock slot="eight" id="eight">
base-styles.css
```css
/* THIS IS ALL JAKE ARCHIBALD'S CODE!! 

I DIDN'T WRITE THIS, I JUST ADDED SOME SHITTY JS!! */

:root {
  --white: #fff;
  --primary-text: #212121;
  --secondary-text: #757575;
  --divider: #bdbdbd;
  --primary-color: #673ab7;
  --primary-dark: #512da8;
  --primary-light: #d1c4e9;
  --accent-color: #ff9800;
  --content-padding: 1.2rem;
  
  color: var(--primary-text);
  font-family: system-ui, sans-serif;
  font-size: 16px;
  line-height: 1.5;
}

body {
  margin: 0;
}

* {
  -webkit-tap-highlight-color: transparent;
}

.main-header {
  align-items: center;
  background: var(--primary-color);
  color: var(--white);
  contain: paint;
  display: grid;
  height: 54px;
  padding: 0 var(--content-padding);
}

.back-and-title {
  align-items: center;
  display: grid;
  gap: 0.3rem;
  grid-template-columns: 31px 1fr;
  color: inherit;
  text-decoration: none;
}

.content {
  padding: var(--content-padding);
}

.content-title {
  font-size: 1.6rem;
  font-weight: 600;
  margin: 0;
  max-width: 43ch;
}

.back-icon {
  display: block;
  fill: var(--white);
}

.gallery {
  display: grid;
  gap: var(--content-padding);
  grid-template-columns: repeat(auto-fill,minmax(300px,1fr));
  margin: 1rem 0;
  padding: 0;
}

.gallery > li {
  display: block;
  box-shadow: 0 5px 12px rgb(0 0 0 / 34%);
}

.gallery a {
  color: inherit;
  text-decoration: none;
}

.gallery img {
  display: block;
  width: 100%;
  height: auto;
  aspect-ratio: 16/9;
}

.square-gallery {
  grid-template-columns: repeat(auto-fill,minmax(230px,1fr));
}

.square-gallery img {
  aspect-ratio: 1/1;
  object-fit: cover;
}

.gallery-item-title {
  padding: 1rem;
  display: block;
  text-align: center;
}

.banner-img img {
  display: block;
  width: 100%;
  height: auto;
  max-width: 1170px;
}

.banner-img {
  display: block;
  background: var(--divider);
}

.content-alt {
  background: #d4bbff;
}

.body-grid {
  height: -webkit-fill-available;
}

.body-grid body {
  height: 100vh;
  height: -webkit-fill-available;
  display: grid;
  grid-template-rows: max-content 1fr;
}

@media (min-width: 530px) {
  .content-and-nav {
    display: grid;
    grid-template-columns: 1fr 180px;
  }
}

.main-nav {
  background: #d4bbff;
}

.main-nav ul {
  margin: 0;
  padding: 0;
}

.main-nav li {
  display: block;
}

.main-nav li a {
  display: grid;
  grid-template-columns: max-content 1fr;
  gap: 0.7rem;
  padding: 1rem;
  color: #000;
  text-decoration: none;
}

.main-nav li a::before {
  content: '➡️';
}
```
</CodeBlock>
<CodeBlock slot="nine" id="nine">
styles.css
```css
/* THIS IS ALL JAKE ARCHIBALD'S CODE!! 

I DIDN'T WRITE THIS, I JUST ADDED SOME SHITTY JS!! */
@property --num-to-display {
  inherits: false;
  initial-value: 0;
  syntax: "<integer>";
}

html,
body {
  min-height: 100svh;
}

body {
  display: grid;
  grid-template-rows: auto 1fr auto;
}

.survey-progress {
  --tick-size: 50px;
}

.survey-ticks {
  position: relative;
  height: var(--tick-size);
  margin: 50px 75px;
  --minor-tick-background: #d1d1d1;
  --ticks-count: 7;
}

.survey-ticks::before {
  content: "";
  position: absolute;
  inset: 0 0 auto 0;
  top: 50%;
  translate: 0 -50%;
  height: 2px;
  background: var(--minor-tick-background);
}

.survey-ticks > * {
  position: absolute;
  top: 50%;
  left: calc(100% * var(--tick-pos) / (var(--ticks-count) - 1));
  translate: -50% -50%;
  background: var(--minor-tick-background);
  width: var(--tick-size);
  height: var(--tick-size);
  border-radius: var(--tick-size);
}

.survey-ticks > .survey-current {
  --tick-size: 75px;
  background: #737373;
  overflow: clip;
  view-transition-name: survey-current;
}

@keyframes progress-counter {
  from {
    --num-to-display: calc(
      (var(--from-step, var(--step)) - 1) / (var(--ticks-count) - 1) * 100
    );
  }
  to {
    --num-to-display: calc((var(--step) - 1) / (var(--ticks-count) - 1) * 100);
  }
}

.survey-current-nums {
  height: 100%;
  font-size: 2rem;
  color: #fff;
  position: absolute;
  inset: 0;
  display: grid;
  text-align: center;
  align-content: center;
  counter-reset: yo var(--num-to-display);
  animation: progress-counter 500ms both ease;
}

.survey-current-nums::before {
  content: counter(yo);
}

::view-transition-group(*) {
  animation-duration: 500ms;
}

::view-transition-old(survey-current) {
  display: none;
}

::view-transition-new(survey-current) {
  animation: none;
}
```
</CodeBlock>
<CodeBlock slot="ten" id="ten">
script.js
```js
const getStep = (path) => /step-(\d)\.html$/.exec(path)?.[1] || "1"
const fromStep = getStep(document.referrer)
const toStep = getStep(location.href)

document.documentElement.style.setProperty("--from-step", fromStep)
document.documentElement.style.setProperty("--step", toStep)
```
</CodeBlock>
</MPADemo>